import{d as S,h as f,q as J,y,A as T,z as d,C as R,B as K,V as Q,J as q,r as A,ah as Z,u as B,K as F,L as G,g as k,a3 as X,ab as Y,ai as _,I as ee,a_ as te,bv as re,ac as M,v as ae,aN as D,bw as oe,aQ as ne,a8 as le,bh as se,al as P,M as ie,b8 as ce,a4 as de,o as j,c as O,a as z,bk as ue}from"./index-DVUYEo1S.js";import{x}from"./_plugin-vue_export-helper-D0l3HQ5W.js";const fe=S({name:"ChevronLeft",render(){return f("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},f("path",{d:"M10.3536 3.14645C10.5488 3.34171 10.5488 3.65829 10.3536 3.85355L6.20711 8L10.3536 12.1464C10.5488 12.3417 10.5488 12.6583 10.3536 12.8536C10.1583 13.0488 9.84171 13.0488 9.64645 12.8536L5.14645 8.35355C4.95118 8.15829 4.95118 7.84171 5.14645 7.64645L9.64645 3.14645C9.84171 2.95118 10.1583 2.95118 10.3536 3.14645Z",fill:"currentColor"}))}});function pe(n){const{fontWeight:i,textColor1:a,textColor2:o,textColorDisabled:c,dividerColor:l,fontSize:p}=n;return{titleFontSize:p,titleFontWeight:i,dividerColor:l,titleTextColor:a,titleTextColorDisabled:c,fontSize:p,textColor:o,arrowColor:o,arrowColorDisabled:c,itemMargin:"16px 0 0 0",titlePadding:"16px 0 0 0"}}const ge={common:J,self:pe},me=y("collapse","width: 100%;",[y("collapse-item",`
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 margin: var(--n-item-margin);
 `,[T("disabled",[d("header","cursor: not-allowed;",[d("header-main",`
 color: var(--n-title-text-color-disabled);
 `),y("collapse-item-arrow",`
 color: var(--n-arrow-color-disabled);
 `)])]),y("collapse-item","margin-left: 32px;"),R("&:first-child","margin-top: 0;"),R("&:first-child >",[d("header","padding-top: 0;")]),T("left-arrow-placement",[d("header",[y("collapse-item-arrow","margin-right: 4px;")])]),T("right-arrow-placement",[d("header",[y("collapse-item-arrow","margin-left: 4px;")])]),d("content-wrapper",[d("content-inner","padding-top: 16px;"),K({duration:"0.15s"})]),T("active",[d("header",[T("active",[y("collapse-item-arrow","transform: rotate(90deg);")])])]),R("&:not(:first-child)","border-top: 1px solid var(--n-divider-color);"),Q("disabled",[T("trigger-area-main",[d("header",[d("header-main","cursor: pointer;"),y("collapse-item-arrow","cursor: default;")])]),T("trigger-area-arrow",[d("header",[y("collapse-item-arrow","cursor: pointer;")])]),T("trigger-area-extra",[d("header",[d("header-extra","cursor: pointer;")])])]),d("header",`
 font-size: var(--n-title-font-size);
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 transition: color .3s var(--n-bezier);
 position: relative;
 padding: var(--n-title-padding);
 color: var(--n-title-text-color);
 `,[d("header-main",`
 display: flex;
 flex-wrap: nowrap;
 align-items: center;
 font-weight: var(--n-title-font-weight);
 transition: color .3s var(--n-bezier);
 flex: 1;
 color: var(--n-title-text-color);
 `),d("header-extra",`
 display: flex;
 align-items: center;
 transition: color .3s var(--n-bezier);
 color: var(--n-text-color);
 `),y("collapse-item-arrow",`
 display: flex;
 transition:
 transform .15s var(--n-bezier),
 color .3s var(--n-bezier);
 font-size: 18px;
 color: var(--n-arrow-color);
 `)])])]),he=Object.assign(Object.assign({},B.props),{defaultExpandedNames:{type:[Array,String],default:null},expandedNames:[Array,String],arrowPlacement:{type:String,default:"left"},accordion:{type:Boolean,default:!1},displayDirective:{type:String,default:"if"},triggerAreas:{type:Array,default:()=>["main","extra","arrow"]},onItemHeaderClick:[Function,Array],"onUpdate:expandedNames":[Function,Array],onUpdateExpandedNames:[Function,Array],onExpandedNamesChange:{type:[Function,Array],validator:()=>!0,default:void 0}}),L=X("n-collapse"),Te=S({name:"Collapse",props:he,slots:Object,setup(n,{slots:i}){const{mergedClsPrefixRef:a,inlineThemeDisabled:o,mergedRtlRef:c}=q(n),l=A(n.defaultExpandedNames),p=k(()=>n.expandedNames),w=Z(p,l),C=B("Collapse","-collapse",me,ge,n,a);function g(r){const{"onUpdate:expandedNames":e,onUpdateExpandedNames:t,onExpandedNamesChange:u}=n;t&&_(t,r),e&&_(e,r),u&&_(u,r),l.value=r}function h(r){const{onItemHeaderClick:e}=n;e&&_(e,r)}function s(r,e,t){const{accordion:u}=n,{value:v}=w;if(u)r?(g([e]),h({name:e,expanded:!0,event:t})):(g([]),h({name:e,expanded:!1,event:t}));else if(!Array.isArray(v))g([e]),h({name:e,expanded:!0,event:t});else{const I=v.slice(),E=I.findIndex($=>e===$);~E?(I.splice(E,1),g(I),h({name:e,expanded:!1,event:t})):(I.push(e),g(I),h({name:e,expanded:!0,event:t}))}}Y(L,{props:n,mergedClsPrefixRef:a,expandedNamesRef:w,slots:i,toggleItem:s});const m=F("Collapse",c,a),N=k(()=>{const{common:{cubicBezierEaseInOut:r},self:{titleFontWeight:e,dividerColor:t,titlePadding:u,titleTextColor:v,titleTextColorDisabled:I,textColor:E,arrowColor:$,fontSize:U,titleFontSize:H,arrowColorDisabled:V,itemMargin:W}}=C.value;return{"--n-font-size":U,"--n-bezier":r,"--n-text-color":E,"--n-divider-color":t,"--n-title-padding":u,"--n-title-font-size":H,"--n-title-text-color":v,"--n-title-text-color-disabled":I,"--n-title-font-weight":e,"--n-arrow-color":$,"--n-arrow-color-disabled":V,"--n-item-margin":W}}),b=o?G("collapse",void 0,N,n):void 0;return{rtlEnabled:m,mergedTheme:C,mergedClsPrefix:a,cssVars:o?void 0:N,themeClass:b==null?void 0:b.themeClass,onRender:b==null?void 0:b.onRender}},render(){var n;return(n=this.onRender)===null||n===void 0||n.call(this),f("div",{class:[`${this.mergedClsPrefix}-collapse`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse--rtl`,this.themeClass],style:this.cssVars},this.$slots)}}),ve=S({name:"CollapseItemContent",props:{displayDirective:{type:String,required:!0},show:Boolean,clsPrefix:{type:String,required:!0}},setup(n){return{onceTrue:re(M(n,"show"))}},render(){return f(ee,null,{default:()=>{const{show:n,displayDirective:i,onceTrue:a,clsPrefix:o}=this,c=i==="show"&&a,l=f("div",{class:`${o}-collapse-item__content-wrapper`},f("div",{class:`${o}-collapse-item__content-inner`},this.$slots));return c?te(l,[[ae,n]]):n?l:null}})}}),ye={title:String,name:[String,Number],disabled:Boolean,displayDirective:String},Ie=S({name:"CollapseItem",props:ye,setup(n){const{mergedRtlRef:i}=q(n),a=ne(),o=le(()=>{var s;return(s=n.name)!==null&&s!==void 0?s:a}),c=de(L);c||se("collapse-item","`n-collapse-item` must be placed inside `n-collapse`.");const{expandedNamesRef:l,props:p,mergedClsPrefixRef:w,slots:C}=c,g=k(()=>{const{value:s}=l;if(Array.isArray(s)){const{value:m}=o;return!~s.findIndex(N=>N===m)}else if(s){const{value:m}=o;return m!==s}return!0});return{rtlEnabled:F("Collapse",i,w),collapseSlots:C,randomName:a,mergedClsPrefix:w,collapsed:g,triggerAreas:M(p,"triggerAreas"),mergedDisplayDirective:k(()=>{const{displayDirective:s}=n;return s||p.displayDirective}),arrowPlacement:k(()=>p.arrowPlacement),handleClick(s){let m="main";P(s,"arrow")&&(m="arrow"),P(s,"extra")&&(m="extra"),p.triggerAreas.includes(m)&&c&&!n.disabled&&c.toggleItem(g.value,o.value,s)}}},render(){const{collapseSlots:n,$slots:i,arrowPlacement:a,collapsed:o,mergedDisplayDirective:c,mergedClsPrefix:l,disabled:p,triggerAreas:w}=this,C=D(i.header,{collapsed:o},()=>[this.title]),g=i["header-extra"]||n["header-extra"],h=i.arrow||n.arrow;return f("div",{class:[`${l}-collapse-item`,`${l}-collapse-item--${a}-arrow-placement`,p&&`${l}-collapse-item--disabled`,!o&&`${l}-collapse-item--active`,w.map(s=>`${l}-collapse-item--trigger-area-${s}`)]},f("div",{class:[`${l}-collapse-item__header`,!o&&`${l}-collapse-item__header--active`]},f("div",{class:`${l}-collapse-item__header-main`,onClick:this.handleClick},a==="right"&&C,f("div",{class:`${l}-collapse-item-arrow`,key:this.rtlEnabled?0:1,"data-arrow":!0},D(h,{collapsed:o},()=>[f(ie,{clsPrefix:l},{default:()=>this.rtlEnabled?f(fe,null):f(ce,null)})])),a==="left"&&C),oe(g,{collapsed:o},s=>f("div",{class:`${l}-collapse-item__header-extra`,onClick:this.handleClick,"data-extra":!0},s))),f(ve,{clsPrefix:l,displayDirective:c,show:!o},i))}}),we={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ne=S({name:"ArrowForward",render:function(i,a){return j(),O("svg",we,a[0]||(a[0]=[z("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M268 112l144 144l-144 144"},null,-1),z("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M392 256H100"},null,-1)]))}}),Ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Se=S({name:"Search",render:function(i,a){return j(),O("svg",Ce,a[0]||(a[0]=[z("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0 0 34.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 0 0 327.3 362.6l94.09 94.09a25 25 0 0 0 35.3-35.3zM97.92 222.72a124.8 124.8 0 1 1 124.8 124.8a124.95 124.95 0 0 1-124.8-124.8z",fill:"currentColor"},null,-1)]))}}),Ae=ue("syncTask",()=>{const n=A([]),i=A(null),a=A(!1),o=A(null);async function c(){a.value=!0,o.value=null;try{const r=await x("list_tasks");n.value=r.map(e=>{let t={mysqlConfig:void 0,esConfig:void 0,syncConfig:void 0};try{e.config&&(t=JSON.parse(e.config))}catch(u){console.error("解析任务配置失败:",u)}return{id:e.id,name:e.name,sourceId:e.sourceId,targetId:e.targetId,sourceType:e.sourceType,targetType:e.targetType,mysqlConfig:t.mysqlConfig,esConfig:t.esConfig,syncConfig:t.syncConfig&&Object.keys(t.syncConfig).length>0?t.syncConfig:{threadCount:4,batchSize:1e3,errorStrategy:"skip",tableExistsStrategy:"drop"},status:e.status,createdAt:e.createdAt,updatedAt:e.updatedAt}})}catch(r){throw o.value=`获取任务列表失败: ${r}`,console.error("fetchTasks error:",r),r}finally{a.value=!1}}async function l(r){try{const e=await x("get_task",{id:r});if(!e)return null;let t={mysqlConfig:void 0,esConfig:void 0,syncConfig:void 0};try{e.config&&(t=JSON.parse(e.config))}catch(v){console.error("解析任务配置失败:",v)}const u={id:e.id,name:e.name,sourceId:e.sourceId,targetId:e.targetId,sourceType:e.sourceType,targetType:e.targetType,mysqlConfig:t.mysqlConfig,esConfig:t.esConfig,syncConfig:t.syncConfig&&Object.keys(t.syncConfig).length>0?t.syncConfig:{threadCount:4,batchSize:1e3,errorStrategy:"skip",tableExistsStrategy:"drop"},status:e.status,createdAt:e.createdAt,updatedAt:e.updatedAt};return i.value=u,u}catch(e){return o.value=`获取任务失败: ${e}`,console.error("getTask error:",e),null}}async function p(r){a.value=!0,o.value=null;try{const e=crypto.randomUUID(),t=Date.now(),u={mysqlConfig:r.mysqlConfig,esConfig:r.esConfig,syncConfig:r.syncConfig},v={id:e,name:r.name,sourceId:r.sourceId,targetId:r.targetId,sourceType:r.sourceType,targetType:r.targetType,config:JSON.stringify(u),status:r.status,createdAt:t,updatedAt:t};return await x("create_task",{task:v}),await c(),e}catch(e){throw o.value=`创建任务失败: ${e}`,console.error("createTask error:",e),e}finally{a.value=!1}}async function w(r,e){a.value=!0,o.value=null;try{const t=Date.now(),u={mysqlConfig:e.mysqlConfig,esConfig:e.esConfig,syncConfig:e.syncConfig},v={id:r,name:e.name,sourceId:e.sourceId,targetId:e.targetId,sourceType:e.sourceType,targetType:e.targetType,config:JSON.stringify(u),status:e.status,createdAt:e.createdAt||t,updatedAt:t};await x("update_task",{id:r,task:v}),await c()}catch(t){throw o.value=`更新任务失败: ${t}`,console.error("updateTask error:",t),t}finally{a.value=!1}}async function C(r){a.value=!0,o.value=null;try{await x("delete_task",{id:r}),await c()}catch(e){throw o.value=`删除任务失败: ${e}`,console.error("deleteTask error:",e),e}finally{a.value=!1}}async function g(r){a.value=!0,o.value=null;try{return await x("get_databases",{sourceId:r})}catch(e){throw o.value=`获取数据库列表失败: ${e}`,console.error("fetchDatabases error:",e),e}finally{a.value=!1}}async function h(r,e){a.value=!0,o.value=null;try{return await x("get_tables",{sourceId:r,database:e})}catch(t){throw o.value=`获取表列表失败: ${t}`,console.error("fetchTables error:",t),t}finally{a.value=!1}}async function s(r){a.value=!0,o.value=null;try{return await x("get_indices",{sourceId:r})}catch(e){throw o.value=`获取索引列表失败: ${e}`,console.error("fetchIndices error:",e),e}finally{a.value=!1}}async function m(r,e){a.value=!0,o.value=null;try{return await x("match_indices",{sourceId:r,pattern:e})}catch(t){throw o.value=`匹配索引失败: ${t}`,console.error("matchIndices error:",t),t}finally{a.value=!1}}function N(r){i.value=r}function b(){o.value=null}return{tasks:n,currentTask:i,loading:a,error:o,fetchTasks:c,getTask:l,createTask:p,updateTask:w,deleteTask:C,fetchDatabases:g,fetchTables:h,fetchIndices:s,matchIndices:m,setCurrentTask:N,clearError:b}});export{Ne as A,Te as N,Se as S,Ie as a,Ae as u};
