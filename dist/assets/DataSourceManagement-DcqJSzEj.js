const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/event-BUlYtK1V.js","assets/index-DVUYEo1S.js","assets/index-C09MWYsF.css","assets/_plugin-vue_export-helper-D0l3HQ5W.js"])))=>i.map(i=>d[i]);
import{d as L,h as z,S as be,r as g,u as _e,o as u,c as _,a as j,b as Ce,F as J,e as s,f as e,w as l,g as W,i as v,t as C,j as ee,k as d,N as w,l as q,m as ze,_ as fe}from"./index-DVUYEo1S.js";import{N as K,a as x,b as xe,c as ge,B as A,u as Te,h as Z,R as Ne,n as ye,d as we,s as Ie,e as ve,_ as De}from"./_plugin-vue_export-helper-D0l3HQ5W.js";import{N as Ee,a as Me,b as ke}from"./event-BUlYtK1V.js";import{N as S,a as he,A as Be,b as Oe,c as Ae,d as U,e as H,f as Pe,g as Re,h as Ve,i as Ue,E as qe,D as Le}from"./Trash-DEa9IH0a.js";const $e=Object.assign(Object.assign({},_e.props),{trigger:String,xScrollable:Boolean,onScroll:Function,contentClass:String,contentStyle:[Object,String],size:Number,yPlacement:{type:String,default:"right"},xPlacement:{type:String,default:"bottom"}}),Se=L({name:"Scrollbar",props:$e,setup(){const T=g(null);return Object.assign(Object.assign({},{scrollTo:(...p)=>{var b;(b=T.value)===null||b===void 0||b.scrollTo(p[0],p[1])},scrollBy:(...p)=>{var b;(b=T.value)===null||b===void 0||b.scrollBy(p[0],p[1])}}),{scrollbarInstRef:T})},render(){return z(be,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}}),je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},$=L({name:"CheckmarkCircle",render:function(h,p){return u(),_("svg",je,p[0]||(p[0]=[j("path",{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208s208-93.31 208-208S370.69 48 256 48zm108.25 138.29l-134.4 160a16 16 0 0 1-12 5.71h-.27a16 16 0 0 1-11.89-5.3l-57.6-64a16 16 0 1 1 23.78-21.4l45.29 50.32l122.59-145.91a16 16 0 0 1 24.5 20.58z",fill:"currentColor"},null,-1)]))}}),Fe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},te=L({name:"CloseCircle",render:function(h,p){return u(),_("svg",Fe,p[0]||(p[0]=[j("path",{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208s208-93.31 208-208S370.69 48 256 48zm75.31 260.69a16 16 0 1 1-22.62 22.62L256 278.63l-52.69 52.68a16 16 0 0 1-22.62-22.62L233.37 256l-52.68-52.69a16 16 0 0 1 22.62-22.62L256 233.37l52.69-52.68a16 16 0 0 1 22.62 22.62L278.63 256z",fill:"currentColor"},null,-1)]))}}),Qe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},We=L({name:"Eye",render:function(h,p){return u(),_("svg",Qe,p[0]||(p[0]=[j("circle",{cx:"256",cy:"256",r:"64",fill:"currentColor"},null,-1),j("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96c-42.52 0-84.33 12.15-124.27 36.11c-40.73 24.43-77.63 60.12-109.68 106.07a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416c46.71 0 93.81-14.43 136.2-41.72c38.46-24.77 72.72-59.66 99.08-100.92a32.2 32.2 0 0 0-.1-34.76zM256 352a96 96 0 1 1 96-96a96.11 96.11 0 0 1-96 96z",fill:"currentColor"},null,-1)]))}}),Ze={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ge=L({name:"EyeOff",render:function(h,p){return u(),_("svg",Ze,p[0]||(p[0]=[Ce('<path d="M432 448a15.92 15.92 0 0 1-11.31-4.69l-352-352a16 16 0 0 1 22.62-22.62l352 352A16 16 0 0 1 432 448z" fill="currentColor"></path><path d="M248 315.85l-51.79-51.79a2 2 0 0 0-3.39 1.69a64.11 64.11 0 0 0 53.49 53.49a2 2 0 0 0 1.69-3.39z" fill="currentColor"></path><path d="M264 196.15L315.87 248a2 2 0 0 0 3.4-1.69a64.13 64.13 0 0 0-53.55-53.55a2 2 0 0 0-1.72 3.39z" fill="currentColor"></path><path d="M491 273.36a32.2 32.2 0 0 0-.1-34.76c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.68 96a226.54 226.54 0 0 0-71.82 11.79a4 4 0 0 0-1.56 6.63l47.24 47.24a4 4 0 0 0 3.82 1.05a96 96 0 0 1 116 116a4 4 0 0 0 1.05 3.81l67.95 68a4 4 0 0 0 5.4.24a343.81 343.81 0 0 0 67.24-77.4z" fill="currentColor"></path><path d="M256 352a96 96 0 0 1-93.3-118.63a4 4 0 0 0-1.05-3.81l-66.84-66.87a4 4 0 0 0-5.41-.23c-24.39 20.81-47 46.13-67.67 75.72a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.39 76.14 98.28 100.65C162.06 402 207.92 416 255.68 416a238.22 238.22 0 0 0 72.64-11.55a4 4 0 0 0 1.61-6.64l-47.47-47.46a4 4 0 0 0-3.81-1.05A96 96 0 0 1 256 352z" fill="currentColor"></path>',5)]))}}),He={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},me=L({name:"TimeOutline",render:function(h,p){return u(),_("svg",He,p[0]||(p[0]=[j("path",{d:"M256 64C150 64 64 150 64 256s86 192 192 192s192-86 192-192S362 64 256 64z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),j("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 128v144h96"},null,-1)]))}}),Je=L({__name:"BatchTestDialog",props:{modelValue:{type:Boolean},dataSources:{}},emits:["update:modelValue","test"],setup(T,{expose:h,emit:p}){const b=T,E=p,I=W({get:()=>b.modelValue,set:o=>E("update:modelValue",o)}),k=g(!1),r=g([]),M=g(!1),i=g(0),N=g("step1"),c=g(new Set),m=g(new Set),X=W(()=>b.dataSources);function P(o){const a=r.value.find(t=>t.dataSourceId===o);return a&&a.steps.length>=1?{dataSourceId:a.dataSourceId,dataSourceName:a.dataSourceName,step:a.steps[0]}:null}function D(o){const a=r.value.find(t=>t.dataSourceId===o);return a&&a.steps.length>=2?{dataSourceId:a.dataSourceId,dataSourceName:a.dataSourceName,step:a.steps[1]}:null}function B(o){if(c.value.has(o))return"loading";const a=P(o);return a?a.step.success?"success":"error":"wait"}function R(o){if(m.value.has(o))return"loading";const a=D(o);return a?a.step.success?"success":"error":"wait"}const O=W(()=>r.value.filter(o=>o.success).length),Y=W(()=>r.value.filter(o=>o.steps.length>0&&!o.success).length),ae=W(()=>{if(r.value.length===0)return 0;const a=r.value.filter(t=>t.steps.length===2).length/r.value.length*100;return isNaN(a)?0:Math.round(a)}),le=W(()=>k.value?"default":Y.value>0?"error":O.value>0?"success":"default");function se(){I.value=!1}function ne(){M.value=!1,N.value="step2",r.value.forEach(o=>{o.steps[0].success&&m.value.add(o.dataSourceId)}),E("test",!0)}function ue(){M.value=!1,k.value=!1}function oe(){k.value=!0,r.value=[],N.value="step1",c.value.clear(),m.value.clear(),b.dataSources.forEach(o=>{c.value.add(o.id)}),E("test",!1)}function re(o){const a=r.value.findIndex(t=>t.dataSourceId===o.dataSourceId);o.steps.length===1?setTimeout(()=>{if(c.value.delete(o.dataSourceId),a>=0?r.value[a]=o:r.value.push(o),k.value&&r.value.every(n=>n.steps.length>=1)&&r.value.length===b.dataSources.length){const n=r.value.filter(f=>!f.steps[0].success).length;n>0?(i.value=n,M.value=!0):setTimeout(()=>{N.value="step2",r.value.forEach(f=>{m.value.add(f.dataSourceId)})},500)}},1e3):o.steps.length===2&&setTimeout(()=>{m.value.delete(o.dataSourceId),a>=0?r.value[a]=o:r.value.push(o)},1e3)}function F(){const o=r.value.filter(a=>a.steps.length===1&&!a.steps[0].success).length;o>0&&(i.value=o,M.value=!0)}function ie(){k.value=!1}return h({startTest:oe,updateResult:re,checkStep1Failures:F,finishTest:ie}),(o,a)=>(u(),_(J,null,[s(e(K),{show:I.value,"onUpdate:show":a[1]||(a[1]=t=>I.value=t),title:"批量测试连接",preset:"card",style:{width:"700px"},closable:!k.value,"mask-closable":!1},{footer:l(()=>[s(e(x),{justify:"end"},{default:l(()=>[s(e(A),{disabled:k.value,onClick:se},{default:l(()=>[...a[7]||(a[7]=[v(" 关闭 ",-1)])]),_:1},8,["disabled"])]),_:1})]),default:l(()=>[s(e(x),{vertical:"",size:16},{default:l(()=>[s(e(xe),{size:"small"},{default:l(()=>[s(e(x),{vertical:"",size:8},{default:l(()=>[s(e(S),null,{default:l(()=>[v("总计: "+C(r.value.length)+" 个数据源",1)]),_:1}),s(e(Ee),{type:"line",percentage:ae.value,status:le.value},null,8,["percentage","status"]),s(e(x),null,{default:l(()=>[s(e(ge),{type:"success"},{default:l(()=>[v("成功: "+C(O.value),1)]),_:1}),s(e(ge),{type:"error"},{default:l(()=>[v("失败: "+C(Y.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(Me),{value:N.value,"onUpdate:value":a[0]||(a[0]=t=>N.value=t),type:"line",animated:""},{default:l(()=>[s(e(ke),{name:"step1",tab:"步骤1: 测试端口连通性"},{default:l(()=>[s(e(Se),{style:{"max-height":"400px"}},{default:l(()=>[s(e(x),{vertical:"",size:8,style:{padding:"8px 0"}},{default:l(()=>[(u(!0),_(J,null,ee(X.value,t=>(u(),_("div",{key:t.id},[s(e(x),{align:"center"},{default:l(()=>{var n;return[B(t.id)==="loading"?(u(),d(e(he),{key:0,size:16})):B(t.id)==="success"?(u(),d(e(w),{key:1,size:16,color:"#18a058"},{default:l(()=>[s(e($))]),_:1})):B(t.id)==="error"?(u(),d(e(w),{key:2,size:16,color:"#d03050"},{default:l(()=>[s(e(te))]),_:1})):(u(),d(e(w),{key:3,size:16,color:"#808080"},{default:l(()=>[s(e(me))]),_:1})),s(e(S),null,{default:l(()=>[v("数据源 "+C(t.name)+":",1)]),_:2},1024),P(t.id)?(u(),d(e(S),{key:4,type:P(t.id).step.success?"success":"error"},{default:l(()=>[v(C(P(t.id).step.message),1)]),_:2},1032,["type"])):B(t.id)==="loading"?(u(),d(e(S),{key:5,depth:"3"},{default:l(()=>[...a[3]||(a[3]=[v(" 测试中... ",-1)])]),_:1})):(u(),d(e(S),{key:6,depth:"3"},{default:l(()=>[...a[4]||(a[4]=[v(" 等待测试 ",-1)])]),_:1})),(n=P(t.id))!=null&&n.step.duration?(u(),d(e(S),{key:7,depth:"3",style:{"font-size":"12px"}},{default:l(()=>[v(" ("+C(P(t.id).step.duration)+"ms) ",1)]),_:2},1024)):q("",!0)]}),_:2},1024)]))),128))]),_:1})]),_:1})]),_:1}),s(e(ke),{name:"step2",tab:"步骤2: 验证账号密码"},{default:l(()=>[s(e(Se),{style:{"max-height":"400px"}},{default:l(()=>[s(e(x),{vertical:"",size:8,style:{padding:"8px 0"}},{default:l(()=>[(u(!0),_(J,null,ee(X.value,t=>(u(),_("div",{key:t.id},[s(e(x),{align:"center"},{default:l(()=>{var n;return[R(t.id)==="loading"?(u(),d(e(he),{key:0,size:16})):R(t.id)==="success"?(u(),d(e(w),{key:1,size:16,color:"#18a058"},{default:l(()=>[s(e($))]),_:1})):R(t.id)==="error"?(u(),d(e(w),{key:2,size:16,color:"#d03050"},{default:l(()=>[s(e(te))]),_:1})):(u(),d(e(w),{key:3,size:16,color:"#808080"},{default:l(()=>[s(e(me))]),_:1})),s(e(S),null,{default:l(()=>[v("数据源 "+C(t.name)+":",1)]),_:2},1024),D(t.id)?(u(),d(e(S),{key:4,type:D(t.id).step.success?"success":"error"},{default:l(()=>[v(C(D(t.id).step.message),1)]),_:2},1032,["type"])):R(t.id)==="loading"?(u(),d(e(S),{key:5,depth:"3"},{default:l(()=>[...a[5]||(a[5]=[v(" 验证中... ",-1)])]),_:1})):(u(),d(e(S),{key:6,depth:"3"},{default:l(()=>[...a[6]||(a[6]=[v(" 等待验证 ",-1)])]),_:1})),(n=D(t.id))!=null&&n.step.duration?(u(),d(e(S),{key:7,depth:"3",style:{"font-size":"12px"}},{default:l(()=>[v(" ("+C(D(t.id).step.duration)+"ms) ",1)]),_:2},1024)):q("",!0)]}),_:2},1024)]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["show","closable"]),s(e(K),{show:M.value,"onUpdate:show":a[2]||(a[2]=t=>M.value=t),preset:"dialog",title:"测试失败",content:`步骤1(端口连通性测试)有 ${i.value} 个数据源失败，是否忽略失败继续测试步骤2(账号密码验证)?`,"positive-text":"忽略失败，继续测试","negative-text":"停止测试",onPositiveClick:ne,onNegativeClick:ue},null,8,["show","content"])],64))}}),Ke={class:"data-source-management"},Xe=L({__name:"DataSourceManagement",setup(T){const h=Te(),p={pageSize:10},b=[{title:"名称",key:"name",minWidth:120,ellipsis:{tooltip:!0}},{title:"类型",key:"type",width:100,render:a=>z(ge,{type:a.type==="mysql"?"info":"success"},{default:()=>a.type==="mysql"?"MySQL":"Elasticsearch"})},{title:"主机",key:"host",minWidth:140,ellipsis:{tooltip:!0}},{title:"端口",key:"port",width:80},{title:"用户名",key:"username",width:100,ellipsis:{tooltip:!0}},{title:"数据库",key:"database",width:100,ellipsis:{tooltip:!0},render:a=>a.database||"-"},{title:"创建时间",key:"createdAt",width:160,render:a=>new Date(a.createdAt).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})},{title:"更新时间",key:"updatedAt",width:160,render:a=>new Date(a.updatedAt).toLocaleString("zh-CN",{timeZone:"Asia/Shanghai",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})},{title:"操作",key:"actions",width:320,fixed:"right",render:a=>z(x,{size:8,wrap:!1},{default:()=>[z(A,{size:"small",onClick:()=>ue(a)},{default:()=>"测试连接",icon:()=>z(w,null,{default:()=>z($)})}),z(A,{size:"small",onClick:()=>ae(a)},{default:()=>"编辑",icon:()=>z(w,null,{default:()=>z(qe)})}),z(A,{size:"small",type:"error",onClick:()=>se(a)},{default:()=>"删除",icon:()=>z(w,null,{default:()=>z(Le)})})]})}],E=g(!1),I=g(!1),k=g(!1),r=g(!1),M=g(null),i=g({name:"",type:"mysql",host:"",port:3306,username:"",password:"",database:""}),N=g(!1),c=g([]),m=g(0),X=[{label:"MySQL",value:"mysql"},{label:"Elasticsearch",value:"elasticsearch"}],P={name:[{required:!0,message:"请输入数据源名称",trigger:"blur"}],type:[{required:!0,message:"请选择数据源类型",trigger:"change"}],host:[{required:!0,message:"请输入主机地址",trigger:"blur"}],port:[{required:!0,type:"number",message:"请输入端口号",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},D=g(!1),B=g(null),R=g(!1),O=g(null);function Y(){k.value=!1,i.value={name:"",type:"mysql",host:"",port:3306,username:"",password:"",database:""},I.value=!1,E.value=!0}function ae(a){k.value=!0,i.value={...a},I.value=!1,E.value=!0}async function le(){var a;try{await((a=M.value)==null?void 0:a.validate()),k.value&&i.value.id?(await h.updateDataSource(i.value.id,i.value),ve("数据源更新成功")):(await h.addDataSource(i.value),ve("数据源添加成功")),E.value=!1,await F()}catch(t){return Z(t,k.value?"更新数据源失败":"添加数据源失败"),!1}}function se(a){B.value=a,D.value=!0}async function ne(){if(B.value)try{await h.deleteDataSource(B.value.id),ve("数据源删除成功"),await F()}catch(a){Z(a,"删除数据源失败")}finally{B.value=null}}async function ue(a){c.value=[{step:1,name:"测试端口连通性",status:"wait"},{step:2,name:"验证账号密码",status:"wait"}],m.value=0,N.value=!0,r.value=!0;const{listen:t}=await fe(async()=>{const{listen:f}=await import("./event-BUlYtK1V.js").then(y=>y.e);return{listen:f}},__vite__mapDeps([0,1,2,3])),n=await t("connection-test-step",f=>{const y=f.payload,V=y.step-1;V>=0&&V<c.value.length&&(c.value[V].status=y.success?"finish":"error",c.value[V].message=y.message,c.value[V].duration=y.duration,m.value=y.step)});try{const f=await h.testConnection(a.id);f.success?ye("连接测试成功","所有测试步骤均通过"):we("连接测试失败",f.message)}catch(f){m.value>0&&m.value<=c.value.length&&(c.value[m.value-1].status="error",c.value[m.value-1].message="测试失败"),Z(f,"连接测试失败")}finally{r.value=!1,n()}}async function oe(){if(!k.value||!i.value.id){Ie("只能在编辑模式下测试连接");return}c.value=[{step:1,name:"测试端口连通性",status:"wait"},{step:2,name:"验证账号密码",status:"wait"}],m.value=0,N.value=!0,r.value=!0;const{listen:a}=await fe(async()=>{const{listen:n}=await import("./event-BUlYtK1V.js").then(f=>f.e);return{listen:n}},__vite__mapDeps([0,1,2,3])),t=await a("connection-test-step",n=>{const f=n.payload,y=f.step-1;y>=0&&y<c.value.length&&(c.value[y].status=f.success?"finish":"error",c.value[y].message=f.message,c.value[y].duration=f.duration,m.value=f.step)});try{const n=await h.testConnection(i.value.id);n.success?ye("连接测试成功","所有测试步骤均通过"):we("连接测试失败",n.message)}catch(n){m.value>0&&m.value<=c.value.length&&(c.value[m.value-1].status="error",c.value[m.value-1].message="测试失败"),Z(n,"连接测试失败")}finally{r.value=!1,t()}}function re(){const a=c.value.some(n=>n.status==="error"),t=c.value.every(n=>n.status==="finish");return a?"error":t?"finish":"process"}async function F(){try{await h.fetchDataSources()}catch(a){Z(a,"加载数据源列表失败")}}async function ie(){var a;console.log("开始批量测试"),R.value=!0,await new Promise(t=>setTimeout(t,100)),console.log("调用 startTest"),(a=O.value)==null||a.startTest()}async function o(a){var t,n,f;console.log("执行批量测试, skipFailedStep1:",a);try{const{listen:y}=await fe(async()=>{const{listen:G}=await import("./event-BUlYtK1V.js").then(Q=>Q.e);return{listen:G}},__vite__mapDeps([0,1,2,3])),V=await y("batch-test-step",G=>{var ce;console.log("收到测试步骤事件:",G.payload);const Q=G.payload;(ce=O.value)==null||ce.updateResult(Q)});console.log("调用后端批量测试...");const de=await h.batchTestConnections(a);if(console.log("批量测试完成, 结果:",de),!a&&!de.results.every(Q=>Q.steps.length===2)&&de.results.filter(pe=>pe.steps.length===1).filter(pe=>!pe.steps[0].success).length>0){console.log("步骤1有失败,显示确认对话框"),(t=O.value)==null||t.checkStep1Failures(),V();return}console.log("测试完成"),(n=O.value)==null||n.finishTest(),V()}catch(y){console.error("批量测试错误:",y),Z(y,"批量测试失败"),(f=O.value)==null||f.finishTest()}}return ze(()=>{F()}),(a,t)=>(u(),_("div",Ke,[s(e(x),{vertical:"",size:16},{default:l(()=>[s(e(x),{justify:"space-between"},{default:l(()=>[s(e(x),null,{default:l(()=>[s(e(A),{type:"primary",onClick:Y},{icon:l(()=>[s(e(w),null,{default:l(()=>[s(e(Be))]),_:1})]),default:l(()=>[t[13]||(t[13]=v(" 添加数据源 ",-1))]),_:1}),s(e(A),{type:"info",onClick:ie,disabled:e(h).dataSources.length===0},{icon:l(()=>[s(e(w),null,{default:l(()=>[s(e($))]),_:1})]),default:l(()=>[t[14]||(t[14]=v(" 批量测试 ",-1))]),_:1},8,["disabled"])]),_:1}),s(e(A),{onClick:F},{icon:l(()=>[s(e(w),null,{default:l(()=>[s(e(Ne))]),_:1})]),default:l(()=>[t[15]||(t[15]=v(" 刷新 ",-1))]),_:1})]),_:1}),s(e(Oe),{columns:b,data:e(h).dataSources,loading:e(h).loading,pagination:p,bordered:!1,"scroll-x":1400,"max-height":600},null,8,["data","loading"])]),_:1}),s(e(K),{show:E.value,"onUpdate:show":t[8]||(t[8]=n=>E.value=n),title:k.value?"编辑数据源":"添加数据源",preset:"dialog","positive-text":k.value?"保存":"添加","negative-text":"取消",onPositiveClick:le,style:{width:"600px"}},{default:l(()=>[s(e(Ae),{ref_key:"formRef",ref:M,model:i.value,rules:P,"label-placement":"left","label-width":"100","require-mark-placement":"right-hanging"},{default:l(()=>[s(e(U),{label:"名称",path:"name"},{default:l(()=>[s(e(H),{value:i.value.name,"onUpdate:value":t[0]||(t[0]=n=>i.value.name=n),placeholder:"请输入数据源名称"},null,8,["value"])]),_:1}),s(e(U),{label:"类型",path:"type"},{default:l(()=>[s(e(Pe),{value:i.value.type,"onUpdate:value":t[1]||(t[1]=n=>i.value.type=n),options:X,placeholder:"请选择数据源类型"},null,8,["value"])]),_:1}),s(e(U),{label:"主机",path:"host"},{default:l(()=>[s(e(H),{value:i.value.host,"onUpdate:value":t[2]||(t[2]=n=>i.value.host=n),placeholder:"请输入主机地址"},null,8,["value"])]),_:1}),s(e(U),{label:"端口",path:"port"},{default:l(()=>[s(e(Re),{value:i.value.port,"onUpdate:value":t[3]||(t[3]=n=>i.value.port=n),min:1,max:65535,placeholder:"请输入端口号",style:{width:"100%"}},null,8,["value"])]),_:1}),s(e(U),{label:"用户名",path:"username"},{default:l(()=>[s(e(H),{value:i.value.username,"onUpdate:value":t[4]||(t[4]=n=>i.value.username=n),placeholder:"请输入用户名"},null,8,["value"])]),_:1}),s(e(U),{label:"密码",path:"password"},{default:l(()=>[s(e(H),{value:i.value.password,"onUpdate:value":t[6]||(t[6]=n=>i.value.password=n),type:I.value?"text":"password",placeholder:"请输入密码"},{suffix:l(()=>[s(e(w),{component:I.value?e(Ge):e(We),onClick:t[5]||(t[5]=n=>I.value=!I.value),style:{cursor:"pointer"}},null,8,["component"])]),_:1},8,["value","type"])]),_:1}),i.value.type==="mysql"?(u(),d(e(U),{key:0,label:"数据库名",path:"database"},{default:l(()=>[s(e(H),{value:i.value.database,"onUpdate:value":t[7]||(t[7]=n=>i.value.database=n),placeholder:"请输入数据库名（可选）"},null,8,["value"])]),_:1})):q("",!0),k.value?(u(),d(e(U),{key:1,label:" "},{default:l(()=>[s(e(A),{type:"info",loading:r.value,onClick:oe},{icon:l(()=>[s(e(w),null,{default:l(()=>[s(e($))]),_:1})]),default:l(()=>[t[16]||(t[16]=v(" 测试连接 ",-1))]),_:1},8,["loading"])]),_:1})):q("",!0)]),_:1},8,["model"])]),_:1},8,["show","title","positive-text"]),s(e(K),{show:D.value,"onUpdate:show":t[9]||(t[9]=n=>D.value=n),preset:"dialog",title:"确认删除",content:"确定要删除这个数据源吗？此操作不可恢复。","positive-text":"删除","negative-text":"取消",onPositiveClick:ne},null,8,["show"]),s(e(K),{show:N.value,"onUpdate:show":t[11]||(t[11]=n=>N.value=n),title:"测试连接",preset:"card",style:{width:"500px"},closable:!r.value,"mask-closable":!1},{footer:l(()=>[s(e(x),{justify:"end"},{default:l(()=>[s(e(A),{disabled:r.value,onClick:t[10]||(t[10]=n=>N.value=!1)},{default:l(()=>[...t[18]||(t[18]=[v(" 关闭 ",-1)])]),_:1},8,["disabled"])]),_:1})]),default:l(()=>[s(e(x),{vertical:"",size:16},{default:l(()=>[s(e(Ve),{current:m.value,status:re()},{default:l(()=>[(u(!0),_(J,null,ee(c.value,n=>(u(),d(e(Ue),{key:n.step,title:n.name,description:n.message||"等待执行"},{icon:l(()=>[n.status==="finish"?(u(),d(e(w),{key:0,color:"#18a058"},{default:l(()=>[s(e($))]),_:1})):n.status==="error"?(u(),d(e(w),{key:1,color:"#d03050"},{default:l(()=>[s(e(te))]),_:1})):n.status==="process"?(u(),d(e(he),{key:2,size:20})):q("",!0)]),_:2},1032,["title","description"]))),128))]),_:1},8,["current","status"]),c.value.length>0?(u(),d(e(xe),{key:0,size:"small"},{default:l(()=>[s(e(x),{vertical:"",size:8},{default:l(()=>[(u(!0),_(J,null,ee(c.value,n=>(u(),_("div",{key:n.step},[n.status!=="wait"?(u(),d(e(S),{key:0},{default:l(()=>[s(e(w),{color:n.status==="finish"?"#18a058":n.status==="error"?"#d03050":"#2080f0",style:{"vertical-align":"middle","margin-right":"8px"}},{default:l(()=>[n.status==="finish"?(u(),d(e($),{key:0})):n.status==="error"?(u(),d(e(te),{key:1})):(u(),d(e(me),{key:2}))]),_:2},1032,["color"]),s(e(S),{strong:""},{default:l(()=>[v("步骤"+C(n.step)+": "+C(n.name),1)]),_:2},1024),n.duration?(u(),d(e(S),{key:0,depth:"3",style:{"margin-left":"8px"}},{default:l(()=>[v(" ("+C(n.duration)+"ms) ",1)]),_:2},1024)):q("",!0),t[17]||(t[17]=j("br",null,null,-1)),s(e(S),{depth:"2",style:{"margin-left":"32px"}},{default:l(()=>[v(C(n.message),1)]),_:2},1024)]),_:2},1024)):q("",!0)]))),128))]),_:1})]),_:1})):q("",!0)]),_:1})]),_:1},8,["show","closable"]),s(Je,{ref_key:"batchTestDialogRef",ref:O,modelValue:R.value,"onUpdate:modelValue":t[12]||(t[12]=n=>R.value=n),"data-sources":e(h).dataSources,onTest:o},null,8,["modelValue","data-sources"])]))}}),lt=De(Xe,[["__scopeId","data-v-5d240dd7"]]);export{lt as default};
