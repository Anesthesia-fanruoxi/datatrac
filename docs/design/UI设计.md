# UI 设计

## 📋 文档说明

本文档定义 DataTrac 系统的 UI 设计规范，包括整体布局、页面设计、组件样式等。

**文档版本**: v1.0  
**最后更新**: 2026-01-30  
**设计工具**: Figma / 手绘草图

---

## 🎨 整体布局

### 应用框架

```
┌─────────────────────────────────────────────────────────────┐
│  DataTrac 数据同步工具                          [- □ ×]      │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────┐  ┌──────────────────────────────────────┐ │
│  │             │  │                                        │ │
│  │  侧边导航    │  │          主内容区                      │ │
│  │             │  │                                        │ │
│  │  📊 数据源   │  │                                        │ │
│  │  ⚙️  任务配置 │  │                                        │ │
│  │  📈 任务监控  │  │                                        │ │
│  │             │  │                                        │ │
│  │             │  │                                        │ │
│  └─────────────┘  └──────────────────────────────────────┘ │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**尺寸规范**:
- 窗口最小宽度: 1200px
- 窗口最小高度: 700px
- 侧边栏宽度: 200px
- 主内容区: 自适应

---

## 📄 页面设计

### 1. 数据源管理页面

#### 布局结构

```
┌─────────────────────────────────────────────────────────────┐
│  数据源管理                                    [+ 新建数据源]  │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────────┐│
│  │  🔍 搜索框                          [MySQL ▼] [全部 ▼]  ││
│  └─────────────────────────────────────────────────────────┘│
│                                                               │
│  ┌─────────────────────────────────────────────────────────┐│
│  │  数据源列表 (表格)                                        ││
│  │  ┌──────┬────────┬──────┬──────┬──────┬────────────┐   ││
│  │  │ 名称 │ 类型   │ 地址 │ 端口 │ 状态 │ 操作       │   ││
│  │  ├──────┼────────┼──────┼──────┼──────┼────────────┤   ││
│  │  │ MySQL│ MySQL  │ ... │ 3306 │ ✓   │ 测试 编辑  │   ││
│  │  │ ES-1 │ ES     │ ... │ 9200 │ ✓   │ 测试 编辑  │   ││
│  │  └──────┴────────┴──────┴──────┴──────┴────────────┘   ││
│  └─────────────────────────────────────────────────────────┘│
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

#### 组件说明

**顶部操作栏**:
- 标题: "数据源管理" (18px, 粗体)
- 新建按钮: 主色按钮，右上角

**搜索和筛选区**:
- 搜索框: 左侧，占 60% 宽度
- 类型筛选: 下拉框 (MySQL / Elasticsearch / 全部)
- 状态筛选: 下拉框 (已连接 / 未连接 / 全部)

**数据源列表**:
- 表格形式展示
- 列: 名称、类型、地址、端口、状态、操作
- 状态: ✓ 绿色 / ✗ 红色
- 操作: 测试连接、编辑、删除

#### 新建/编辑数据源对话框

```
┌─────────────────────────────────────────┐
│  新建数据源                      [×]     │
├─────────────────────────────────────────┤
│                                          │
│  数据源类型: [MySQL ▼]                   │
│                                          │
│  名称: [___________________________]     │
│                                          │
│  主机地址: [___________________________] │
│                                          │
│  端口: [3306]                            │
│                                          │
│  用户名: [___________________________]   │
│                                          │
│  密码: [***************************]     │
│                                          │
│  数据库: [___________________________]   │
│         (MySQL 专用，可选)                │
│                                          │
│  ┌────────────────────────────────────┐ │
│  │  [测试连接]                         │ │
│  └────────────────────────────────────┘ │
│                                          │
│              [取消]  [保存]              │
└─────────────────────────────────────────┘
```

**尺寸**: 500px × 600px

---

### 2. 任务配置页面（向导式）

#### 整体布局

```
┌─────────────────────────────────────────────────────────────┐
│  创建同步任务                                                 │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────────┐│
│  │  步骤指示器                                              ││
│  │  ① 选择数据源类型 → ② 选择数据源/目标 → ③ 选择同步对象 → ④ 任务配置 → ⑤ 确认    ││
│  └─────────────────────────────────────────────────────────┘│
│                                                               │
│  ┌─────────────────────────────────────────────────────────┐│
│  │                                                         ││
│  │                                                         ││
│  │                    [ 内容区域 ]                          ││
│  │                                                         ││
│  │                                                         ││
│  │                                                         ││
│  └─────────────────────────────────────────────────────────┘│
│                                                               │
│                     [上一步]  [下一步]                          │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

#### 步骤 1: 任务基本信息

- **任务名称**: 输入框
- **源类型**: 单选卡片 (MySQL / Elasticsearch)
- **目标类型**: 单选卡片 (MySQL / Elasticsearch)
- **操作**: 点击“创建任务并配置”，生成任务 ID 并进入下一步

#### 步骤 2: 数据源实例选择

- **源实例**: 下拉选择 (已配置的数据源)
- **目标实例**: 下拉选择 (已配置的数据源)
- **验证**: 自动检查源和目标是否可用

#### 步骤 3: 同步对象选择 (动态)

**场景 A: MySQL 源**
- **展示形式**: 双栏穿梭框 (Tree Transfer)
- **左侧**: 源数据库树 (库 -> 表)
  - 顶部搜索框
  - 支持全选库或单选表
- **右侧**: 已选对象树
  - 展示已选的表结构
  - 支持移除
- **操作**: 点击中间箭头进行添加/移除

**场景 B: Elasticsearch 源**
- **展示形式**: 关键字搜索 + 列表
- **输入**: 索引匹配模式 (如 `log-*`)
- **预览**: 实时列出匹配的索引列表
- **选择**: 勾选确认要同步的索引

#### 步骤 4: 任务配置 (Pipeline)

- **并发设置**:
  - 线程数 (Slider + Input, 默认 4)
  - 批次大小 (Input, 默认 1000)
- **错误策略**:
  - 单选: 跳过错误 / 暂停任务
- **高级选项**:
  - 写入模式 (Insert / Upsert)
  - 索引副本数/分片数 (仅目标为 ES 时显示)

#### 步骤 5: 确认

- **展示**: 任务概览卡片
- **内容**: 源/目标信息、同步对象数量、关键配置参数
- **操作**: "完成" 按钮，保存并返回列表

---

### 3. 任务监控页面

#### 布局结构

```
┌─────────────────────────────────────────────────────────────┐
│  任务监控                                                     │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────────┐ ┌───────────────────────────────────────┐ │
│  │ 任务列表      │ │  任务详情区域                          │ │
│  │              │ │                                       │ │
│  │ [搜索框]     │ │  ┌─────────────────────────────────┐  │ │
│  │              │ │  │ 顶部控制栏 (标题 + 状态 + 按钮)   │  │ │
│  │ ┌──────────┐ │ │  └─────────────────────────────────┘  │ │
│  │ │ 任务 A   │ │ │                                       │ │
│  │ │ 🟢 运行中 │ │ │  ┌───────┐ ┌───────┐ ┌───────┐      │ │
│  │ └──────────┘ │ │  │ 速率  │ │ 进度  │ │ 计数  │      │ │
│  │              │ │  └───────┘ └───────┘ └───────┘      │ │
│  │ ┌──────────┐ │ │                                       │ │
│  │ │ 任务 B   │ │ │  ┌─────────────────────────────────┐  │ │
│  │ │ 🔴 失败   │ │ │  │  同步单元列表 / 日志控制台       │  │ │
│  │ └──────────┘ │ │  │                                 │  │ │
│  │              │ │  │                                 │  │ │
│  │              │ │  └─────────────────────────────────┘  │ │
│  └──────────────┘ └───────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

#### 左侧: 任务列表

- **顶部**: 搜索框 + 刷新按钮 + 新建按钮
- **统计条**: 总计 / 运行中 / 失败 (胶囊样式)
- **列表项**:
  - 任务名称
  - 源 -> 目标 (图标指示)
  - 状态标签 (运行中/暂停/失败/完成)
  - 迷你进度条
- **交互**: 点击切换右侧详情

#### 右侧: 任务详情

**A. 顶部控制栏**
- **左侧**: 任务名称 + 状态标签 + 源/目标信息
- **右侧**: 操作按钮组 (启动 / 暂停 / 继续 / 终止)

**B. 实时指标卡片**
- **实时速率**: 条/秒 (带波形图标)
- **总体进度**: 百分比 (带环形进度图)
- **已处理记录**: 数字 (带堆叠图标)
- **预计剩余时间**: 时间格式 (带时钟图标)

**C. 数据面板 (Tabs)**

- **Tab 1: 同步进度 (默认)**
  - **过滤器**: 全部 / 进行中 / 失败 / 完成
  - **列表**: 展示每个表/索引的同步状态
  - **行内容**: 名称、进度条、已处理/总数、状态标签
  - **错误提示**: 失败项显示错误原因 tooltip

- **Tab 2: 运行日志**
  - **样式**: 黑色背景终端风格
  - **功能**: 自动滚动开关、清空按钮
  - **内容**: [时间] [级别] [模块] 日志内容
  - **配色**: Info(蓝) / Warn(黄) / Error(红)