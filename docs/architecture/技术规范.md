# æŠ€æœ¯è§„èŒƒ

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£å®šä¹‰ DataTrac ç³»ç»Ÿçš„æŠ€æœ¯è§„èŒƒï¼ŒåŒ…æ‹¬æŠ€æœ¯é€‰å‹ã€å‘½åè§„èŒƒã€æ•°æ®æ ¼å¼è§„èŒƒç­‰ã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2026-01-30  
**é€‚ç”¨èŒƒå›´**: å‰ç«¯å’Œåç«¯

---

## ğŸ¯ æŠ€æœ¯é€‰å‹

### å‰ç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|------|---------|
| Vue 3 | 3.x | å‰ç«¯æ¡†æ¶ | ç»„åˆå¼ APIã€æ€§èƒ½ä¼˜ç§€ã€ç”Ÿæ€å®Œå–„ |
| TypeScript | 5.x | ç±»å‹ç³»ç»Ÿ | ç±»å‹å®‰å…¨ã€ä»£ç æç¤ºã€å‡å°‘é”™è¯¯ |
| Vite | 5.x | æ„å»ºå·¥å…· | å¿«é€Ÿå¯åŠ¨ã€çƒ­æ›´æ–°ã€ç°ä»£åŒ– |
| Pinia | 2.x | çŠ¶æ€ç®¡ç† | è½»é‡ã€ç±»å‹å‹å¥½ã€Vue 3 å®˜æ–¹æ¨è |
| Naive UI | 2.x | UI ç»„ä»¶åº“ | TypeScript åŸç”Ÿã€ç»„ä»¶ä¸°å¯Œã€ä¸»é¢˜å®šåˆ¶ |
| Vue Router | 4.x | è·¯ç”±ç®¡ç† | Vue å®˜æ–¹è·¯ç”±ã€æ”¯æŒ TypeScript |

### åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰å‹ç†ç”± |
|------|------|------|---------|
| Rust | 1.75+ | åç«¯è¯­è¨€ | å†…å­˜å®‰å…¨ã€é«˜æ€§èƒ½ã€å¹¶å‘å‹å¥½ |
| Tauri | 2.x | æ¡Œé¢æ¡†æ¶ | è½»é‡ã€å®‰å…¨ã€è·¨å¹³å°ã€å‰åç«¯åˆ†ç¦» |
| Tokio | 1.x | å¼‚æ­¥è¿è¡Œæ—¶ | é«˜æ€§èƒ½å¼‚æ­¥ã€ç”Ÿæ€å®Œå–„ |
| SQLx | 0.7+ | æ•°æ®åº“é©±åŠ¨ | ç¼–è¯‘æ—¶æ£€æŸ¥ã€å¼‚æ­¥ã€ç±»å‹å®‰å…¨ |
| SQLite | 3.x | å…ƒæ•°æ®å­˜å‚¨ | è½»é‡ã€æ— éœ€é…ç½®ã€äº‹åŠ¡æ”¯æŒ |
| Serde | 1.x | åºåˆ—åŒ– | é«˜æ€§èƒ½ã€ç±»å‹å®‰å…¨ã€ç”Ÿæ€å®Œå–„ |

### æ•°æ®æºæŠ€æœ¯

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| MySQL | 5.7+ / 8.0+ | å…³ç³»å‹æ•°æ®åº“ |
| Elasticsearch | 7.x / 8.x | æœç´¢å¼•æ“ |

---

## ğŸ“ å‘½åè§„èŒƒ

### ç»Ÿä¸€ä½¿ç”¨ camelCase

**åŸåˆ™**: å‰åç«¯é€šè®¯ç»Ÿä¸€ä½¿ç”¨ camelCaseï¼Œé¿å…å‘½åä¸ä¸€è‡´å¯¼è‡´çš„æ··ä¹±ã€‚

#### å‰ç«¯ (TypeScript)

```typescript
// âœ… æ­£ç¡®
interface TaskProgress {
  taskId: string;
  totalRecords: number;
  processedRecords: number;
  startTime: string;
}

// âŒ é”™è¯¯
interface TaskProgress {
  task_id: string;        // ä¸è¦ä½¿ç”¨ snake_case
  TotalRecords: number;   // ä¸è¦ä½¿ç”¨ PascalCaseï¼ˆé™¤äº†ç±»å‹åï¼‰
}
```

#### åç«¯ (Rust)

```rust
// âœ… æ­£ç¡® - ä½¿ç”¨ serde è‡ªåŠ¨è½¬æ¢
#[derive(Serialize, Deserialize)]
#[serde(rename_all = "camelCase")]
pub struct TaskProgress {
    pub task_id: String,           // Rust å†…éƒ¨ä½¿ç”¨ snake_case
    pub total_records: u64,
    pub processed_records: u64,
    pub start_time: String,
}

// åºåˆ—åŒ–åè‡ªåŠ¨è½¬æ¢ä¸º:
// {
//   "taskId": "...",
//   "totalRecords": 100,
//   "processedRecords": 50,
//   "startTime": "..."
// }
```

#### æ•°æ®åº“ (SQLite)

```sql
-- æ•°æ®åº“ä½¿ç”¨ snake_case
CREATE TABLE task_unit_runtimes (
    id TEXT PRIMARY KEY,
    task_id TEXT NOT NULL,
    unit_name TEXT NOT NULL,
    total_records INTEGER DEFAULT 0,
    processed_records INTEGER DEFAULT 0
);
```

**è¯´æ˜**: 
- å‰ç«¯å’Œåç«¯é€šè®¯ä½¿ç”¨ camelCase
- Rust å†…éƒ¨ä½¿ç”¨ snake_caseï¼ˆç¬¦åˆ Rust è§„èŒƒï¼‰
- é€šè¿‡ serde çš„ `rename_all = "camelCase"` è‡ªåŠ¨è½¬æ¢
- æ•°æ®åº“ä½¿ç”¨ snake_caseï¼ˆç¬¦åˆ SQL è§„èŒƒï¼‰

---

## ğŸ”„ è¯·æ±‚ä½“å’Œè¿”å›ä½“è§„èŒƒ

### ç»Ÿä¸€å“åº”æ ¼å¼

**ä¸ä½¿ç”¨ç»Ÿä¸€åŒ…è£…**ï¼Œç›´æ¥è¿”å›æ•°æ®æˆ–é”™è¯¯ã€‚

#### æˆåŠŸå“åº”

```typescript
// å‰ç«¯è°ƒç”¨
const dataSources = await invoke<DataSource[]>('list_data_sources');
// ç›´æ¥è¿”å›æ•°æ®æ•°ç»„

const task = await invoke<SyncTask>('get_sync_task', { taskId: '123' });
// ç›´æ¥è¿”å›å¯¹è±¡
```

#### é”™è¯¯å“åº”

```typescript
// å‰ç«¯è°ƒç”¨
try {
  await invoke('start_sync_task', { taskId: '123' });
} catch (error) {
  // Tauri ä¼šè‡ªåŠ¨å°† Rust çš„ Result::Err è½¬æ¢ä¸º JavaScript å¼‚å¸¸
  console.error('å¯åŠ¨ä»»åŠ¡å¤±è´¥:', error);
}
```

#### åç«¯å®ç°

```rust
// âœ… æ­£ç¡® - ç›´æ¥è¿”å›æ•°æ®æˆ– Result
#[tauri::command]
pub async fn list_data_sources(
    state: State<'_, AppState>
) -> Result<Vec<DataSource>, String> {
    let sources = state.storage.load_all_data_sources().await
        .map_err(|e| e.to_string())?;
    Ok(sources)
}

// âŒ é”™è¯¯ - ä¸è¦ä½¿ç”¨ç»Ÿä¸€åŒ…è£…
pub struct ApiResponse<T> {
    success: bool,
    data: Option<T>,
    error: Option<String>,
}
```

---

## ğŸ“Š æ•°æ®ç±»å‹è§„èŒƒ

### æ—¶é—´æ ¼å¼

**ç»Ÿä¸€ä½¿ç”¨æ¯«ç§’æ—¶é—´æˆ³ (i64)**

```typescript
// å‰ç«¯
interface TaskUnit {
  startedAt: number;      // æ¯«ç§’æ—¶é—´æˆ³
  updatedAt: number;      // æ¯«ç§’æ—¶é—´æˆ³
}

// æ˜¾ç¤ºæ—¶è½¬æ¢
const date = new Date(unit.startedAt);
const formatted = date.toLocaleString();
```

```rust
// åç«¯
pub struct TaskUnit {
    pub started_at: Option<i64>,  // æ¯«ç§’æ—¶é—´æˆ³
    pub updated_at: i64,           // æ¯«ç§’æ—¶é—´æˆ³
}

// è·å–å½“å‰æ—¶é—´æˆ³
let now = chrono::Utc::now().timestamp_millis();
```

### ID æ ¼å¼

**ç»Ÿä¸€ä½¿ç”¨ UUID v4 å­—ç¬¦ä¸²**

```typescript
// å‰ç«¯
interface DataSource {
  id: string;  // UUID æ ¼å¼: "550e8400-e29b-41d4-a716-446655440000"
}
```

```rust
// åç«¯
use uuid::Uuid;

let id = Uuid::new_v4().to_string();
// "550e8400-e29b-41d4-a716-446655440000"
```

### æšä¸¾ç±»å‹

**ç»Ÿä¸€ä½¿ç”¨å°å†™å­—ç¬¦ä¸²**

```typescript
// å‰ç«¯
type TaskStatus = 'idle' | 'running' | 'paused' | 'completed' | 'failed';
type DataSourceType = 'mysql' | 'elasticsearch';
```

```rust
// åç«¯
#[derive(Serialize, Deserialize)]
#[serde(rename_all = "lowercase")]
pub enum TaskStatus {
    Idle,
    Running,
    Paused,
    Completed,
    Failed,
}

// åºåˆ—åŒ–ä¸º: "idle", "running", "paused", "completed", "failed"
```

### æ•°å­—ç±»å‹

| ç”¨é€” | å‰ç«¯ | åç«¯ | è¯´æ˜ |
|------|------|------|------|
| è®°å½•æ•° | number | u64 | æ— ç¬¦å· 64 ä½æ•´æ•° |
| ç™¾åˆ†æ¯” | number | f64 | æµ®ç‚¹æ•° 0-100 |
| ç«¯å£å· | number | u16 | æ— ç¬¦å· 16 ä½æ•´æ•° |
| æ—¶é—´æˆ³ | number | i64 | æœ‰ç¬¦å· 64 ä½æ•´æ•°ï¼ˆæ¯«ç§’ï¼‰ |

---

## ğŸ” å®‰å…¨è§„èŒƒ

### å¯†ç åŠ å¯†

**ä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨**

```rust
// åç«¯åŠ å¯†
pub struct CryptoService {
    key: [u8; 32],
}

impl CryptoService {
    pub fn encrypt(&self, plaintext: &str) -> Result<String> {
        // AES-256-GCM åŠ å¯†
        // è¿”å› Base64 ç¼–ç çš„å¯†æ–‡
    }
    
    pub fn decrypt(&self, ciphertext: &str) -> Result<String> {
        // Base64 è§£ç  + AES-256-GCM è§£å¯†
        // è¿”å›æ˜æ–‡
    }
}
```

**å‰ç«¯ä¸å­˜å‚¨å¯†ç **ï¼Œæ¯æ¬¡éœ€è¦æ—¶ä»åç«¯è·å–å¹¶è§£å¯†ã€‚

### æ•°æ®æºè¿æ¥

**ä¸åœ¨å‰ç«¯å­˜å‚¨è¿æ¥ä¿¡æ¯**ï¼Œæ‰€æœ‰è¿æ¥ç”±åç«¯ç®¡ç†ã€‚

---

## ğŸ“ ç›®å½•ç»“æ„è§„èŒƒ

### å‰ç«¯ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ api/                    # API è°ƒç”¨å±‚
â”‚   â”œâ”€â”€ datasource.ts
â”‚   â”œâ”€â”€ task.ts
â”‚   â””â”€â”€ monitor.ts
â”œâ”€â”€ assets/                 # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/
â”‚   â””â”€â”€ styles/
â”œâ”€â”€ components/             # é€šç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ common/            # åŸºç¡€ç»„ä»¶
â”‚   â””â”€â”€ business/          # ä¸šåŠ¡ç»„ä»¶
â”œâ”€â”€ router/                 # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ stores/                 # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ datasource.ts
â”‚   â”œâ”€â”€ task.ts
â”‚   â””â”€â”€ monitor.ts
â”œâ”€â”€ types/                  # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ format.ts
â”‚   â””â”€â”€ validate.ts
â”œâ”€â”€ views/                  # é¡µé¢è§†å›¾
â”‚   â”œâ”€â”€ DataSourceManagement.vue
â”‚   â”œâ”€â”€ SyncTaskConfig.vue
â”‚   â””â”€â”€ TaskMonitor.vue
â”œâ”€â”€ App.vue                 # æ ¹ç»„ä»¶
â””â”€â”€ main.ts                 # å…¥å£æ–‡ä»¶
```

### åç«¯ç›®å½•ç»“æ„

```
src-tauri/src/
â”œâ”€â”€ commands.rs             # Tauri Commands
â”œâ”€â”€ crypto.rs               # åŠ å¯†æœåŠ¡
â”œâ”€â”€ datasource.rs           # æ•°æ®æºç®¡ç†å™¨
â”œâ”€â”€ error_logger.rs         # é”™è¯¯æ—¥å¿—
â”œâ”€â”€ lib.rs                  # åº“å…¥å£
â”œâ”€â”€ main.rs                 # ç¨‹åºå…¥å£
â”œâ”€â”€ progress.rs             # è¿›åº¦ç›‘æ§å™¨
â”œâ”€â”€ progress_logger.rs      # è¿›åº¦æ—¥å¿—
â”œâ”€â”€ task_manager.rs         # ä»»åŠ¡ç®¡ç†å™¨
â”œâ”€â”€ type_mapper.rs          # ç±»å‹æ˜ å°„
â”œâ”€â”€ storage/                # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ models.rs
â”‚   â”œâ”€â”€ data_source_ops.rs
â”‚   â”œâ”€â”€ sync_task_ops.rs
â”‚   â””â”€â”€ task_unit_ops.rs
â””â”€â”€ sync_engine/            # åŒæ­¥å¼•æ“
    â”œâ”€â”€ mod.rs
    â”œâ”€â”€ types.rs
    â”œâ”€â”€ task_loader.rs
    â”œâ”€â”€ state_manager.rs
    â”œâ”€â”€ mysql_sync.rs
    â”œâ”€â”€ es_sync.rs
    â”œâ”€â”€ utils.rs
    â””â”€â”€ implementations/
        â”œâ”€â”€ mod.rs
        â”œâ”€â”€ mysql_to_mysql.rs
        â”œâ”€â”€ mysql_to_es.rs
        â”œâ”€â”€ es_to_mysql.rs
        â””â”€â”€ es_to_es.rs
```

---

## ğŸ”§ ä»£ç è§„èŒƒ

### æ–‡ä»¶å¤§å°é™åˆ¶

**å•ä¸ªä»£ç æ–‡ä»¶ä¸è¶…è¿‡ 300 è¡Œ**ï¼ˆæ–‡æ¡£æ–‡ä»¶é™¤å¤–ï¼‰

- è¶…è¿‡ 300 è¡Œéœ€è¦æ‹†åˆ†æˆå¤šä¸ªå°æ–‡ä»¶
- æŒ‰åŠŸèƒ½æ¨¡å—æ‹†åˆ†
- ä¿æŒå•ä¸€èŒè´£åŸåˆ™

### æ³¨é‡Šè§„èŒƒ

```rust
// Rust æ³¨é‡Š
/// å‡½æ•°è¯´æ˜ï¼ˆæ–‡æ¡£æ³¨é‡Šï¼‰
/// 
/// # å‚æ•°
/// - `task_id`: ä»»åŠ¡ ID
/// 
/// # è¿”å›
/// è¿”å›ä»»åŠ¡å•å…ƒåˆ—è¡¨
pub async fn load_task_units(&self, task_id: &str) -> Result<Vec<TaskUnit>> {
    // å®ç°é€»è¾‘
}
```

```typescript
// TypeScript æ³¨é‡Š
/**
 * å¯åŠ¨åŒæ­¥ä»»åŠ¡
 * @param taskId ä»»åŠ¡ ID
 * @returns Promise<void>
 */
async function startTask(taskId: string): Promise<void> {
  // å®ç°é€»è¾‘
}
```

### é”™è¯¯å¤„ç†

```rust
// Rust é”™è¯¯å¤„ç†
use anyhow::{Result, Context};

pub async fn load_task(&self, id: &str) -> Result<SyncTask> {
    let task = self.storage.load_task(id).await
        .context("åŠ è½½ä»»åŠ¡å¤±è´¥")?
        .ok_or_else(|| anyhow::anyhow!("ä»»åŠ¡ä¸å­˜åœ¨: {}", id))?;
    Ok(task)
}
```

```typescript
// TypeScript é”™è¯¯å¤„ç†
try {
  await invoke('start_sync_task', { taskId });
  message.success('ä»»åŠ¡å¯åŠ¨æˆåŠŸ');
} catch (error) {
  message.error(`ä»»åŠ¡å¯åŠ¨å¤±è´¥: ${error}`);
  console.error(error);
}
```

---

## ğŸ¨ UI è§„èŒƒ

### é¢œè‰²è§„èŒƒ

| ç”¨é€” | é¢œè‰²å€¼ | è¯´æ˜ |
|------|--------|------|
| ä¸»è‰² | #18a058 | æˆåŠŸã€ç¡®è®¤ |
| è­¦å‘Š | #f0a020 | è­¦å‘Šæç¤º |
| é”™è¯¯ | #d03050 | é”™è¯¯ã€å¤±è´¥ |
| ä¿¡æ¯ | #2080f0 | ä¿¡æ¯æç¤º |
| æ–‡æœ¬ | #333333 | ä¸»è¦æ–‡æœ¬ |
| æ¬¡è¦æ–‡æœ¬ | #666666 | æ¬¡è¦æ–‡æœ¬ |
| è¾¹æ¡† | #e0e0e0 | è¾¹æ¡†é¢œè‰² |
| èƒŒæ™¯ | #f5f5f5 | èƒŒæ™¯é¢œè‰² |

### é—´è·è§„èŒƒ

| çº§åˆ« | å¤§å° | ç”¨é€” |
|------|------|------|
| xs | 4px | æœ€å°é—´è· |
| sm | 8px | å°é—´è· |
| md | 16px | ä¸­ç­‰é—´è· |
| lg | 24px | å¤§é—´è· |
| xl | 32px | è¶…å¤§é—´è· |

### å­—ä½“è§„èŒƒ

| ç”¨é€” | å¤§å° | ç²—ç»† |
|------|------|------|
| æ ‡é¢˜ | 18px | 600 |
| å‰¯æ ‡é¢˜ | 16px | 500 |
| æ­£æ–‡ | 14px | 400 |
| å°å­— | 12px | 400 |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [API æ¥å£è®¾è®¡](./APIæ¥å£è®¾è®¡.md) - æ¥å£è¯¦ç»†å®šä¹‰
- [å‰åç«¯é€šè®¯](./å‰åç«¯é€šè®¯.md) - é€šè®¯æœºåˆ¶
- [æ•°æ®åº“è®¾è®¡](./æ•°æ®åº“è®¾è®¡.md) - æ•°æ®åº“ç»“æ„
- [UI è®¾è®¡](../design/UIè®¾è®¡.md) - UI å¸ƒå±€å’Œæ ·å¼

---

**æ–‡æ¡£ç»´æŠ¤**: DataTrac å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2026-01-30
